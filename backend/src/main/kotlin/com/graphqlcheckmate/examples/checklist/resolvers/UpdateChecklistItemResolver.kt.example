// EXAMPLE: Update Checklist Item Resolver
//
// This file demonstrates how to implement a resource update resolver using the framework.
//
// KEY CONCEPTS DEMONSTRATED:
// - Handling partial updates (null values not updated)
// - Using GlobalID from input directly (avoiding re-encoding)
// - Database RLS + @requiresGroupMembership policy enforcement
// - Updating mutable fields while preserving immutable ones
//
// TO USE THIS EXAMPLE:
// 1. Copy to backend/src/main/kotlin/com/graphqlcheckmate/resolvers/
// 2. Rename to UpdateYourResourceResolver.kt
// 3. Uncomment the code below
// 4. Customize for your resource type

/*
package com.graphqlcheckmate.resolvers

import com.graphqlcheckmate.resolvers.resolverbases.MutationResolvers
import viaduct.api.Resolver
import viaduct.api.grts.ChecklistItem

/**
 * Resolver for the updateChecklistItem mutation.
 * Updates a checklist item (completion status and/or title).
 *
 * Authorization: Viaduct @requiresGroupMembership policy ensures only group members can update.
 * Additionally, database RLS policies provide a second layer of security.
 */
@Resolver
class UpdateChecklistItemResolver : MutationResolvers.UpdateChecklistItem() {
    override suspend fun resolve(ctx: Context): ChecklistItem {
        val input = ctx.arguments.input

        // Decode GlobalID to internal UUID
        val itemId = input.id.internalID

        val client = ctx.authenticatedClient

        // Update the item with the provided values
        // Note: null values are not updated (partial update support)
        // The database method should handle null values appropriately
        val itemEntity = client.updateChecklistItem(
            id = itemId,
            completed = input.completed,
            title = input.title
        )

        // Build the response
        // Performance tip: Reuse the GlobalID from input instead of re-encoding
        return ChecklistItem.Builder(ctx)
            .id(input.id)  // Reuse GlobalID from input
            .title(itemEntity.title)
            .completed(itemEntity.completed)
            .userId(itemEntity.user_id)
            .groupId(itemEntity.group_id)
            .createdAt(itemEntity.created_at)
            .updatedAt(itemEntity.updated_at)
            .build()
    }
}
*/
